targets=(
  "centos"
  "ubuntu"
)
pkgname="carbonio-mbox-admin-console-war"
pkgver="1.0.0"
pkgrel="1"
pkgdesc="Carbonio Admin Console War"
pkgdesclong=(
  "Carbonio Admin Console War"
)
arch="amd64"
maintainer="Zextras <packages@zextras.com>"
url="https://zextras.com"
depends=(
  "carbonio-store-components"
)
conflicts=(
  "carbonio-mbox-admin-common"
)
section="mail"
priority="optional"

package() {
  cd "${srcdir}"/../../

  install -D opt/zextras/conf/templates/admin/admin/Widgets.template \
    "${pkgdir}/opt/zextras/conf/templates/admin/admin/Widgets.template"
  install -D opt/zextras/conf/templates/admin/calendar/Appointment.template \
    "${pkgdir}/opt/zextras/conf/templates/admin/calendar/Appointment.template"
  install -D opt/zextras/conf/templates/admin/dwt/Widgets.template \
    "${pkgdir}/opt/zextras/conf/templates/admin/dwt/Widgets.template"
  install -D opt/zextras/conf/templates/admin/zimbra/Widgets.template \
    "${pkgdir}/opt/zextras/conf/templates/admin/zimbra/Widgets.template"
  install -D opt/zextras/jetty_base/etc/zimbraAdmin-jetty-env.xml.in \
    "${pkgdir}/opt/zextras/jetty_base/etc/zimbraAdmin-jetty-env.xml.in"
  install -D opt/zextras/jetty_base/etc/zimbraAdmin.web.xml.in \
    "${pkgdir}/opt/zextras/jetty_base/etc/zimbraAdmin.web.xml.in"

  install -Ddm755 "${pkgdir}/opt/zextras/jetty_base/webapps/zimbraAdmin"
  rsync -a \
    --exclude='TzMsg*' \
    --exclude='AjxTimezoneData.js' \
    opt/zextras/jetty_base/webapps/zimbraAdmin/ \
    "${pkgdir}/opt/zextras/jetty_base/webapps/zimbraAdmin"

  rm -rf "${pkgdir}/opt/zextras/jetty_base/webapps/zimbraAdmin/help"
}
